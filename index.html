<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Control de Fracciones</title>

<style>
body{
    font-family: 'Segoe UI', sans-serif;
    margin:0;
    background: linear-gradient(135deg,#2c3e50,#4ca1af);
    color:#333;
}
.container{
    max-width:1000px;
    margin:auto;
    padding:20px;
}
.card{
    background:white;
    padding:25px;
    border-radius:16px;
    box-shadow:0 10px 25px rgba(0,0,0,0.25);
    margin-bottom:20px;
}
h1{
    text-align:center;
    color:white;
}
button{
    padding:10px 15px;
    border:none;
    border-radius:8px;
    background:#3498db;
    color:white;
    font-weight:bold;
    cursor:pointer;
    margin:5px;
}
button:hover{background:#2980b9;}
input{
    padding:6px;
    border-radius:6px;
    border:1px solid #ccc;
    width:70px;
    text-align:center;
}
.correct{color:green;font-weight:bold;}
.incorrect{color:red;font-weight:bold;}
textarea{
    width:100%;
    height:90px;
    margin-top:10px;
}
.progress{
    font-weight:bold;
    margin-bottom:10px;
}
</style>
</head>
<body>

<h1>üìò Plataforma de Fracciones</h1>

<div class="container">

<div class="card">
<button onclick="startPractice()">Modo Pr√°ctica</button>
<button onclick="startExam()">Modo Examen (10)</button>
</div>

<div class="card" id="exerciseCard" style="display:none;">

<div class="progress" id="progress"></div>
<p id="question"></p>

<h3>1Ô∏è‚É£ Calcula el MCM</h3>
<input id="mcm">

<h3>2Ô∏è‚É£ Ajusta las fracciones</h3>
Fracci√≥n 1: <input id="a1n"> / <input id="a1d"><br>
Fracci√≥n 2: <input id="a2n"> / <input id="a2d">

<h3>3Ô∏è‚É£ Fracci√≥n total</h3>
<input id="totaln"> / <input id="totald">

<h3>4Ô∏è‚É£ N√∫mero total de personas</h3>
<input id="peopleTotal">

<h3>5Ô∏è‚É£ Fracci√≥n restante</h3>
<input id="restn"> / <input id="restd">

<h3>6Ô∏è‚É£ Personas restantes</h3>
<input id="peopleRest">

<br><br>
<button onclick="checkAnswer()">Comprobar</button>
<button onclick="showSolution()">Ver soluci√≥n</button>
<button onclick="nextExercise()">Nuevo / Siguiente</button>
<button onclick="skipQuestion()">Saltar (solo examen)</button>

<div id="feedback"></div>
<div id="solution"></div>

<textarea placeholder="‚úèÔ∏è Apuntes..."></textarea>

</div>

<div class="card" id="resultCard" style="display:none;">
<h2>Resultado Final</h2>
<p id="finalScore"></p>
<button onclick="location.reload()">Reiniciar</button>
</div>

</div>

<script>

let mode="practice";
let current=0;
let total=10;
let score=0;
let data;

const contexts=[
"En un torneo de videojuegos",
"En un concierto",
"En una excursi√≥n",
"En una liga deportiva",
"En una feria escolar",
"En un campamento"
];

function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

function gcd(a,b){while(b){[a,b]=[b,a%b];}return a;}
function lcm(a,b){return (a*b)/gcd(a,b);}
function simplify(n,d){let g=gcd(n,d);return[n/g,d/g];}

function generate(){
    let d1=rand(3,12);
    let d2=rand(3,12);
    while(d1===d2){d2=rand(3,12);}
    let n1=rand(1,d1-1);
    let n2=rand(1,d2-1);
    let totalPeople=rand(200,600);

    return{n1,d1,n2,d2,totalPeople,
        context:contexts[rand(0,contexts.length-1)]
    };
}

function startPractice(){
    mode="practice";
    current=0;
    score=0;
    showExercise();
}

function startExam(){
    mode="exam";
    current=0;
    score=0;
    showExercise();
}

function showExercise(){
    if(mode==="exam" && current>=10){endExam();return;}
    data=generate();
    document.getElementById("exerciseCard").style.display="block";
    document.getElementById("resultCard").style.display="none";
    document.getElementById("progress").innerText=
    mode==="exam"?"Pregunta "+(current+1)+" de 10":"Modo pr√°ctica";

    document.getElementById("question").innerHTML=
    `${data.context} participan ${data.totalPeople} personas.
    ${data.n1}/${data.d1} est√°n en una actividad y 
    ${data.n2}/${data.d2} en otra.
    Calcula el total y lo que queda.`;

    document.getElementById("feedback").innerHTML="";
    document.getElementById("solution").innerHTML="";
}

function checkAnswer(){

    let realMcm=lcm(data.d1,data.d2);
    let adj1=data.n1*(realMcm/data.d1);
    let adj2=data.n2*(realMcm/data.d2);
    let totalNum=adj1+adj2;
    let simp=simplify(totalNum,realMcm);

    let peopleTotal=(simp[0]/simp[1])*data.totalPeople;
    let restFrac=[simp[1]-simp[0],simp[1]];
    let restPeople=data.totalPeople-peopleTotal;

    let correct=true;

    if(parseInt(mcm.value)!==realMcm)correct=false;
    if(parseInt(a1n.value)!==adj1||parseInt(a1d.value)!==realMcm)correct=false;
    if(parseInt(a2n.value)!==adj2||parseInt(a2d.value)!==realMcm)correct=false;
    if(parseInt(totaln.value)!==simp[0]||parseInt(totald.value)!==simp[1])correct=false;
    if(parseInt(peopleTotal.value)!==peopleTotal)correct=false;
    if(parseInt(restn.value)!==restFrac[0]||parseInt(restd.value)!==restFrac[1])correct=false;
    if(parseInt(peopleRest.value)!==restPeople)correct=false;

    if(correct){
        feedback.innerHTML="<span class='correct'>‚úî Todo correcto</span>";
        if(mode==="exam")score++;
    }else{
        feedback.innerHTML="<span class='incorrect'>‚úò Hay errores</span>";
    }

    if(mode==="exam")current++;
}

function skipQuestion(){
    if(mode==="exam"){
        current++;
        showExercise();
    }
}

function nextExercise(){
    if(mode==="practice"){
        showExercise();
    }else{
        showExercise();
    }
}

function showSolution(){

    let realMcm=lcm(data.d1,data.d2);
    let adj1=data.n1*(realMcm/data.d1);
    let adj2=data.n2*(realMcm/data.d2);
    let totalNum=adj1+adj2;
    let simp=simplify(totalNum,realMcm);
    let peopleTotal=(simp[0]/simp[1])*data.totalPeople;
    let restFrac=[simp[1]-simp[0],simp[1]];
    let restPeople=data.totalPeople-peopleTotal;

    solution.innerHTML=`
    <hr>
    <b>Paso 1:</b> MCM(${data.d1},${data.d2}) = ${realMcm}<br>
    <b>Paso 2:</b> Ajustamos ‚Üí ${adj1}/${realMcm} + ${adj2}/${realMcm}<br>
    <b>Paso 3:</b> Sumamos ‚Üí ${totalNum}/${realMcm}<br>
    <b>Paso 4:</b> Simplificamos ‚Üí ${simp[0]}/${simp[1]}<br>
    <b>Paso 5:</b> Personas ‚Üí ${peopleTotal}<br>
    <b>Paso 6:</b> Resto ‚Üí ${restFrac[0]}/${restFrac[1]} = ${restPeople} personas
    `;
}

function endExam(){
    exerciseCard.style.display="none";
    resultCard.style.display="block";
    let grade=(score/10)*10;
    finalScore.innerHTML=`Nota final: ${grade.toFixed(2)} / 10`;
}

</script>

</body>
</html>
