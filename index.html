<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practica Fracciones Avanzado</title>
<style>
body { font-family: Arial; background: #f0f0f5; margin:0; padding:20px;}
h1 { text-align:center; }
.exercise { border:2px solid #333; border-radius:8px; background:#fff; padding:15px; margin:20px 0;}
.step { margin:10px 0; }
input, textarea { width:100%; padding:6px; font-size:16px; margin-top:4px; border-radius:4px; border:1px solid #ccc;}
button { margin-top:8px; padding:8px 12px; cursor:pointer; border-radius:4px; border:none; background:#333; color:#fff; font-weight:bold;}
.ok { color:green; font-weight:bold; }
.bad { color:red; font-weight:bold; }
.solution { background:#eef; padding:8px; border-radius:4px; margin-top:8px;}
#progress { width:100%; background:#ccc; border-radius:6px; margin:10px 0; height:20px; overflow:hidden; }
#progress_bar { height:100%; width:0; background:green; }
</style>
</head>
<body>

<h1>Practica Fracciones - Problemas Visuales</h1>

<div id="progress">
  <div id="progress_bar"></div>
</div>

<div id="exercise_container"></div>

<button onclick="nextExercise()">Siguiente ejercicio</button>

<script>
let exercises = [];
let currentEx = 0;
let totalEx = 5;

// Función para generar ejercicios aleatorios
function generateExercises(){
  for(let i=0;i<totalEx;i++){
    // Datos aleatorios
    let total = Math.floor(Math.random()*500)+100; // 100 a 600
    let f1 = Math.floor(Math.random()*4+1); // 1 a 4
    let d1 = [2,3,4,5];
    let f2 = Math.floor(Math.random()*3+1); // 1 a 3
    let d2 = [2,3,4,5];
    // Ajuste denominadores
    let denom1 = d1[Math.floor(Math.random()*d1.length)];
    let denom2 = d2[Math.floor(Math.random()*d2.length)];
    let num1 = Math.floor(total/denom1);
    let num2 = Math.floor(total/denom2);

    exercises.push({
      total: total,
      num1: num1,
      denom1: denom1,
      num2: num2,
      denom2: denom2,
      type: Math.random()>0.5 ? "moda":"comida"
    });
  }
}

// Función para mostrar ejercicio actual
function showExercise(){
  let container = document.getElementById("exercise_container");
  container.innerHTML = "";
  if(currentEx >= exercises.length){
    container.innerHTML = "<h2>¡Has completado todos los ejercicios!</h2>";
    document.getElementById("progress_bar").style.width = "100%";
    return;
  }
  let ex = exercises[currentEx];
  let desc = ex.type==="moda" ? `Una tienda ha vendido ${ex.total} prendas. ${ex.num1}/${ex.total} son camisetas, ${ex.num2}/${ex.total} son sudaderas. El resto son pantalones.` :
    `En una fiesta se han preparado ${ex.total} platos. ${ex.num1}/${ex.total} son pizzas, ${ex.num2}/${ex.total} son hamburguesas. El resto son ensaladas.`;
  
  let html = `<div class="exercise">
    <p><strong>Ejercicio ${currentEx+1}:</strong><br>${desc}</p>
    <div class="step">
      <label>1️⃣ Primer grupo:</label>
      <input type="text" id="step1" placeholder="Número">
      <button onclick="checkStep(1)">Comprobar</button>
      <p id="out1"></p>
    </div>
    <div class="step">
      <label>2️⃣ Segundo grupo:</label>
      <input type="text" id="step2" placeholder="Número">
      <button onclick="checkStep(2)">Comprobar</button>
      <p id="out2"></p>
    </div>
    <div class="step">
      <label>3️⃣ Resto:</label>
      <input type="text" id="step3" placeholder="Número">
      <button onclick="checkStep(3)">Comprobar</button>
      <p id="out3"></p>
    </div>
    <div class="solution" id="solution" style="display:none;">
      <strong>Solución completa:</strong><br>
      Primer grupo: ${ex.num1}<br>
      Segundo grupo: ${ex.num2}<br>
      Resto: ${ex.total - ex.num1 - ex.num2}
    </div>
    <button onclick="showSolution()">Mostrar solución completa</button>
  </div>`;
  
  container.innerHTML = html;
  updateProgress();
}

// Comprobar cada paso
function checkStep(step){
  let ex = exercises[currentEx];
  let val = document.getElementById(`step${step}`).value.trim();
  let out = document.getElementById(`out${step}`);
  let correct;
  if(step===1) correct = ex.num1;
  if(step===2) correct = ex.num2;
  if(step===3) correct = ex.total - ex.num1 - ex.num2;

  if(parseInt(val)===correct){
    out.textContent="✔ Correcto";
    out.className="ok";
  }else{
    out.textContent="✘ Incorrecto, revisa. Sugerencia: "+correct;
    out.className="bad";
  }
}

// Mostrar solución completa
function showSolution(){
  document.getElementById("solution").style.display="block";
}

// Siguiente ejercicio
function nextExercise(){
  currentEx++;
  showExercise();
}

// Barra progreso
function updateProgress(){
  let perc = ((currentEx)/totalEx)*100;
  document.getElementById("progress_bar").style.width = perc+"%";
}

// Inicializar
generateExercises();
showExercise();
</script>

</body>
</html>
