<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practica Fracciones Pro</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Roboto', sans-serif; margin:0; background:#f4f4f9; color:#333; padding:20px;}
h1 { text-align:center; margin-bottom:20px;}
.card { background:#fff; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); padding:20px; margin-bottom:20px;}
.step { margin:15px 0;}
.step input { width:100%; padding:8px; font-size:16px; border-radius:5px; border:1px solid #ccc;}
.step button { margin-top:6px; padding:8px 12px; border:none; border-radius:5px; background:#0077cc; color:#fff; font-weight:bold; cursor:pointer;}
.ok { color:green; font-weight:bold; }
.bad { color:red; font-weight:bold; }
.solution { background:#e6f0ff; padding:10px; border-radius:5px; margin-top:10px;}
#progress { width:100%; background:#ddd; border-radius:10px; overflow:hidden; height:20px; margin-bottom:20px; }
#progress_bar { height:100%; width:0; background:#28a745; transition:width 0.3s;}
</style>
</head>
<body>

<h1>Practica Fracciones Profesional</h1>

<div id="progress"><div id="progress_bar"></div></div>

<div id="exercise_container"></div>

<button onclick="nextExercise()" style="display:block; margin:0 auto; padding:10px 20px; border:none; border-radius:6px; background:#0077cc; color:#fff; font-weight:bold; cursor:pointer;">Siguiente ejercicio</button>

<script>
// Funciones matemáticas
function gcd(a,b){return b?gcd(b,a%b):a;}
function lcm(a,b){return a*b/gcd(a,b);}
function parseFraction(str){let parts=str.split('/'); return {num:parseInt(parts[0]), den:parseInt(parts[1])};}

// Generar ejercicios aleatorios
let exercises=[];
let currentEx=0;
let totalEx=5;

function generateExercises(){
  for(let i=0;i<totalEx;i++){
    let total=Math.floor(Math.random()*500)+100;
    let d1=Math.floor(Math.random()*5+2); // 2 a 6
    let d2=Math.floor(Math.random()*5+2); // 2 a 6
    let n1=Math.floor(total/d1);
    let n2=Math.floor(total/d2);
    let type = Math.random()>0.5 ? "moda":"comida";
    exercises.push({total,n1,d1,n2,d2,type});
  }
}

// Mostrar ejercicio
function showExercise(){
  let container=document.getElementById("exercise_container");
  container.innerHTML="";
  if(currentEx>=exercises.length){
    container.innerHTML="<h2>¡Has completado todos los ejercicios!</h2>";
    document.getElementById("progress_bar").style.width="100%";
    return;
  }
  let ex=exercises[currentEx];
  let desc=ex.type==="moda" ? 
    `Una tienda ha vendido ${ex.total} prendas. ${ex.n1}/${ex.d1} son camisetas, ${ex.n2}/${ex.d2} son sudaderas. El resto son pantalones.` :
    `Se han preparado ${ex.total} platos. ${ex.n1}/${ex.d1} son pizzas, ${ex.n2}/${ex.d2} son hamburguesas. El resto ensaladas.`;

  let html=`<div class="card">
    <p><strong>Ejercicio ${currentEx+1}:</strong><br>${desc}</p>
    <div class="step">
      <label>1️⃣ Primer grupo:</label>
      <input type="text" id="step1" placeholder="Ej: 100">
      <button onclick="checkStep(1)">Comprobar</button>
      <p id="out1"></p>
    </div>
    <div class="step">
      <label>2️⃣ Segundo grupo:</label>
      <input type="text" id="step2" placeholder="Ej: 120">
      <button onclick="checkStep(2)">Comprobar</button>
      <p id="out2"></p>
    </div>
    <div class="step">
      <label>3️⃣ Resto:</label>
      <input type="text" id="step3" placeholder="Ej: 80">
      <button onclick="checkStep(3)">Comprobar</button>
      <p id="out3"></p>
    </div>
    <div class="solution" id="solution" style="display:none;">
      <strong>Solución completa:</strong><br>
      Primer grupo: ${ex.n1} / ${ex.d1} → ${Math.floor(ex.total/ex.d1)}<br>
      Segundo grupo: ${ex.n2} / ${ex.d2} → ${Math.floor(ex.total/ex.d2)}<br>
      Resto: ${ex.total - Math.floor(ex.total/ex.d1) - Math.floor(ex.total/ex.d2)}
    </div>
    <button onclick="showSolution()">Mostrar solución completa</button>
  </div>`;

  container.innerHTML=html;
  updateProgress();
}

// Comprobar pasos
function checkStep(step){
  let ex=exercises[currentEx];
  let val=parseInt(document.getElementById(`step${step}`).value.trim());
  let out=document.getElementById(`out${step}`);
  let correct;
  if(step===1) correct=Math.floor(ex.total/ex.d1);
  if(step===2) correct=Math.floor(ex.total/ex.d2);
  if(step===3) correct=ex.total - Math.floor(ex.total/ex.d1) - Math.floor(ex.total/ex.d2);

  if(val===correct){
    out.textContent="✔ Correcto";
    out.className="ok";
  }else{
    out.textContent=`✘ Incorrecto, sugerencia: ${correct}`;
    out.className="bad";
  }
}

// Mostrar solución completa
function showSolution(){
  document.getElementById("solution").style.display="block";
}

// Siguiente ejercicio
function nextExercise(){
  currentEx++;
  showExercise();
}

// Barra progreso
function updateProgress(){
  let perc=(currentEx/exercises.length)*100;
  document.getElementById("progress_bar").style.width=perc+"%";
}

// Inicializar
generateExercises();
showExercise();
</script>

</body>
</html>
