<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practica Fracciones Kids - Completa</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Roboto', sans-serif; margin:0; background:#f0f8ff; color:#333; padding:20px;}
h1 { text-align:center; margin-bottom:20px;}
.card { background:#fff; border-radius:12px; box-shadow:0 6px 12px rgba(0,0,0,0.12); padding:20px; margin-bottom:25px;}
.step { margin:12px 0; }
.step label { font-weight:500; display:block; margin-bottom:4px; font-size:16px;}
.step input { width:100%; padding:10px; font-size:16px; border-radius:6px; border:1px solid #ccc;}
.step button { margin-top:6px; padding:8px 14px; border:none; border-radius:6px; background:#0077cc; color:#fff; font-weight:bold; cursor:pointer; transition:0.2s; }
.step button:hover { background:#005fa3;}
.ok { color:green; font-weight:bold; }
.bad { color:red; font-weight:bold; }
.solution { background:#e0f7fa; padding:12px; border-radius:6px; margin-top:12px; font-size:15px; }
.notes { margin-top:15px; }
.notes textarea { width:100%; height:80px; padding:8px; border-radius:6px; border:1px solid #ccc; font-size:14px;}
#progress { width:100%; background:#ddd; border-radius:10px; overflow:hidden; height:20px; margin-bottom:20px; }
#progress_bar { height:100%; width:0; background:#28a745; transition:width 0.3s; }
.icon { font-weight:bold; margin-right:6px; }
</style>
</head>
<body>

<h1>Practica Fracciones - Completa</h1>

<div id="progress"><div id="progress_bar"></div></div>

<div id="exercise_container"></div>

<button onclick="nextExercise()" style="display:block; margin:0 auto; padding:10px 20px; border:none; border-radius:6px; background:#0077cc; color:#fff; font-weight:bold; cursor:pointer;">Siguiente ejercicio</button>

<script>
// Funciones matem√°ticas
function gcd(a,b){return b?gcd(b,a%b):a;}
function lcm(a,b){return a*b/gcd(a,b);}
function parseFraction(str){let parts=str.split('/'); return {num:parseInt(parts[0]), den:parseInt(parts[1])};}
function fractionToString(n,d){return n+"/"+d;}

// Generador de ejercicios
let exercises=[];
let currentEx=0;
let totalEx=5;

function generateExercises(){
  for(let i=0;i<totalEx;i++){
    let d1=Math.floor(Math.random()*11)+2; // 2 a 12
    let d2=Math.floor(Math.random()*11)+2;
    let n1=Math.floor(Math.random()*(d1-1))+1;
    let n2=Math.floor(Math.random()*(d2-1))+1;
    let type=Math.random()>0.5?"moda":"comida";
    exercises.push({n1,d1,n2,d2,type});
  }
}

// Mostrar ejercicio
function showExercise(){
  let container=document.getElementById("exercise_container");
  container.innerHTML="";
  if(currentEx>=exercises.length){
    container.innerHTML="<h2>¬°Has completado todos los ejercicios!</h2>";
    document.getElementById("progress_bar").style.width="100%";
    return;
  }

  let ex=exercises[currentEx];
  let desc=ex.type==="moda" ? 
    `Una tienda tiene prendas. ${ex.n1}/${ex.d1} son camisetas, ${ex.n2}/${ex.d2} son sudaderas. El resto son pantalones.` :
    `Se prepararon platos. ${ex.n1}/${ex.d1} son pizzas, ${ex.n2}/${ex.d2} son hamburguesas. El resto ensaladas.`;

  let html=`<div class="card">
    <p><strong>Ejercicio ${currentEx+1}:</strong><br>${desc}</p>

    <div class="step">
      <label>1Ô∏è‚É£ Ajusta las fracciones a denominador com√∫n</label>
      <input type="text" id="step1" placeholder="Ej: 3/4, 5/6">
      <button onclick="checkStep(1)">Comprobar</button>
      <p id="out1"></p>
    </div>

    <div class="step">
      <label>2Ô∏è‚É£ Suma las fracciones</label>
      <input type="text" id="step2" placeholder="Ej: 13/12">
      <button onclick="checkStep(2)">Comprobar</button>
      <p id="out2"></p>
    </div>

    <div class="step">
      <label>3Ô∏è‚É£ Simplifica la fracci√≥n resultante</label>
      <input type="text" id="step3" placeholder="Ej: 1/12">
      <button onclick="checkStep(3)">Comprobar</button>
      <p id="out3"></p>
    </div>

    <button onclick="showSolution()">Mostrar soluci√≥n paso a paso</button>
    <div class="solution" id="solution" style="display:none;"></div>

    <div class="notes">
      <label>üìù Notas personales:</label>
      <textarea placeholder="Apunta tus observaciones o recordatorios..."></textarea>
    </div>
  </div>`;

  container.innerHTML=html;
  updateProgress();
  generateSolution();
}

// Comprobar pasos
function checkStep(step){
  let ex=exercises[currentEx];
  let val=document.getElementById(`step${step}`).value.trim();
  let out=document.getElementById(`out${step}`);
  let m=lcm(ex.d1,ex.d2);
  let n1_adj=ex.n1*(m/ex.d1);
  let n2_adj=ex.n2*(m/ex.d2);
  let sum=n1_adj+n2_adj;
  let g=gcd(sum,m);
  let simplified_n=sum/g;
  let simplified_d=m/g;

  if(step===1){
    let correct=fractionToString(n1_adj,m)+", "+fractionToString(n2_adj,m);
    if(val===correct){
      out.innerHTML='<span class="icon">‚úî</span>Correcto';
      out.className="ok";
    } else {
      out.innerHTML='<span class="icon">‚úò</span>Incorrecto. Ajusta numeradores al MCM ('+m+'). Correcto: '+correct;
      out.className="bad";
    }
  }

  if(step===2){
    let correct=fractionToString(sum,m);
    if(val===correct){
      out.innerHTML='<span class="icon">‚úî</span>Correcto';
      out.className="ok";
    } else {
      out.innerHTML='<span class="icon">‚úò</span>Incorrecto. Suma los numeradores: '+n1_adj+'+'+n2_adj+'='+sum+'. Correcto: '+correct;
      out.className="bad";
    }
  }

  if(step===3){
    let correct=fractionToString(simplified_n,simplified_d);
    if(val===correct){
      out.innerHTML='<span class="icon">‚úî</span>Correcto';
      out.className="ok";
    } else {
      out.innerHTML='<span class="icon">‚úò</span>Incorrecto. Simplifica la fracci√≥n: '+sum+'/'+m+' ‚Üí '+correct;
      out.className="bad";
    }
  }
}

// Generar explicaci√≥n paso a paso
function generateSolution(){
  let ex=exercises[currentEx];
  let m=lcm(ex.d1,ex.d2);
  let n1_adj=ex.n1*(m/ex.d1);
  let n2_adj=ex.n2*(m/ex.d2);
  let sum=n1_adj+n2_adj;
  let g=gcd(sum,m);
  let simplified_n=sum/g;
  let simplified_d=m/g;
  let sol=document.getElementById("solution");
  sol.innerHTML=`<strong>Soluci√≥n paso a paso:</strong><br>
1Ô∏è‚É£ Ajustamos ${ex.n1}/${ex.d1} y ${ex.n2}/${ex.d2} a denominador com√∫n (${m}): ${n1_adj}/${m}, ${n2_adj}/${m}.<br>
2Ô∏è‚É£ Sumamos los numeradores: ${n1_adj}+${n2_adj}=${sum} ‚Üí ${sum}/${m}.<br>
3Ô∏è‚É£ Simplificamos usando MCD(${sum},${m})=${g} ‚Üí fracci√≥n final: ${simplified_n}/${simplified_d}.`;
  sol.style.display="none";
}

// Mostrar soluci√≥n
function showSolution(){
  document.getElementById("solution").style.display="block";
}

// Siguiente ejercicio
function nextExercise(){
  currentEx++;
  showExercise();
}

// Barra progreso
function updateProgress(){
  let perc=(currentEx/exercises.length)*100;
  document.getElementById("progress_bar").style.width=perc+"%";
}

// Inicializar
generateExercises();
showExercise();
</script>

</body>
</html>
